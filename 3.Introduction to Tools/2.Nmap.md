# What is Nmap
Nmap (“Network Mapper”) is a free, open-source tool for network discovery and security auditing. It's widely used by sysadmins and penetration testers for host discovery, port scanning, service fingerprinting, OS detection, and running automated scripts.

# Install
```bash
sudo apt update
sudo apt install nmap
```
Kali typically ships with `nmap` preinstalled.

# Quick command cheats
```bash
# SYN scan (fast, requires raw sockets)
nmap -sS <target>

# Full TCP connect scan (default; slower, noisier)
nmap -sT <target>

# UDP scan (slower, needs sudo)
sudo nmap -sU <target>

# Scan all TCP ports
nmap -p- <target>

# Aggressive + service detection
nmap -A -p 1-65535 <target>

# Common ports + version detection + default scripts
nmap -sV -sC <target>

# Host discovery only
nmap -sn 192.168.1.0/24

# Save output in all formats (basename)
nmap -oA results <target>
```

# Scan types (what they do)

### SYN scan (`-sS`)
```bash
nmap -sS <target>
```
SYN scan, also known as stealth scan is the default and most popular scan option for good reason. It can be performed quickly, scanning thousands of ports per second on a fast network not hampered by intrusive firewalls. Sends SYN packets and inspects responses (SYN/ACK = open, RST = closed). SYN scan is relatively unobtrusive and stealthy, since it never completes TCP handshakes. (requires raw socket privileges on Unix-like systems).

### TCP connect scan (`-sT`)
```bash
nmap -sT <target>
```
Completes the full TCP handshake using the OS network stack. No raw sockets required. Noisier and slower than `-sS`, but works when raw sockets are unavailable.

### UDP scan (`-sU`)
```bash
sudo nmap -sU <target>
```
Sends UDP packets and interprets ICMP port unreachable or other responses. Often slow and noisy; root/administrator privileges are usually needed.

### Host discovery / Network sweep (`-sn`)
```bash
nmap -sn 192.168.1.0/24
```
Performs host discovery (ping sweep), sending ICMP/TCP/ARP probes depending on options. Use `-Pn` to skip host discovery and treat hosts as up.

### Port selection (`-p` / `-p-`)
```bash
nmap -p 22,80,443 <target>
nmap -p- <target>        # scan all 65535 TCP ports
```

### Service/version detection (`-sV`)
```bash
nmap -sV <target>
```
Probes open ports to determine service name and version.

### OS detection (`-O`)
```bash
nmap -O <target>
nmap --osscan-guess <target>
```
Tries to fingerprint the target OS using stack/packet responses. Not always accurate — use as a hint.

### Aggressive scan (`-A`)
```bash
nmap -A <target>
```
Enables OS detection, version detection, script scanning, and traceroute. Useful for recon but increases noise.

### Nmap Scripting Engine (NSE) (`--script`)
```bash
nmap --script=banner -p 80,443 <target>
nmap -sV --script vuln <target>
nmap -sC <target>          # runs default scripts
```
NSE lets you run scripts to enumerate services, check for vulnerabilities, pull banners, brute force, and more. Scripts live in `/usr/share/nmap/scripts/`. Use `nmap --script-help <scriptname>` to see script details.

# Privileges & raw sockets
- Many scan types (notably `-sS`, `-sU`) require raw socket access and therefore root/administrator privileges on Unix-like systems.  
- If you run `nmap` without sufficient privileges, it will automatically fall back to `-sT` (TCP connect).

# Output formats and saving results
```bash
# Save outputs in three formats with basename "scan"
nmap -oA scan -p 1-65535 -sV <target>

# Individual formats:
-oN  normal output
-oX  XML output
-oG  Grepable output
-oA  all three formats (normal, XML, grepable)
```

# Performance tuning & stealth options
- Timing templates: `-T0` (paranoid) … `-T5` (insane). Default is `-T3`.  
  `-T4` is faster and commonly used for local, reliable networks:
  ```bash
  nmap -T4 -p- <target>
  ```
- Rate control: `--min-rate`, `--max-rate` (useful for `masscan`-style behavior but be careful)
- Fragmentation: `-f` (packet fragmentation; may help evade some IDS, but less effective these days)
- Decoys / spoofing: `-D`, `-S` (source address spoofing) — legal/ethical concerns and often unreliable on modern networks.

# Examples
```bash
# Quick service fingerprint of common ports
nmap -sV -p 22,80,443 --script=banner <target>

# Full port SYN scan, version detection, save results
sudo nmap -sS -p- -sV -oA fullscan <target>

# Aggressive scan with OS detection and traceroute
sudo nmap -A <target>

# Ping sweep of a /24 to list alive hosts
nmap -sn 192.168.1.0/24

# Run a specific NSE script (e.g., heartbleed check)
nmap --script ssl-heartbleed -p 443 <target>

# Fast scan for web servers and common directories using proxychains through a pivot:
proxychains nmap -sT -p 80,443 -A 10.10.0.0/24
```

# Notes & best practices
- Always have authorization before scanning external networks. Unauthorized scanning can be illegal and will likely trigger intrusion detection/response.
- `nmap -sS` is efficient but still detectable by modern IDS/IPS. Adjust timing (`-T`) and consider `--scan-delay` / `--max-retries` if you want to be less noisy.
- Use `-oA` or `-oX` to keep machine-readable output for automated parsing.
- For very large port-space or network scans, consider combining `masscan` (for fast port discovery) then feeding results into `nmap` for deeper service/version enumeration.
- Keep your local Nmap script database updated: after adding custom scripts, run `sudo nmap --script-updatedb`.
